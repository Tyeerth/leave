<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.jxust.leave.dao.RoleMapper">


    <select id="selectLeaveFormListForEmployee" resultType="cn.jxust.leave.po.LeaveForm">
         SELECT
         le.id,le.start_time,le.end_time,le.reason,le.days,le.submit_time,le.type,le.student_id,le.state
         FROM
         leave_form le
         INNER JOIN
         (
            SELECT
            s.id,s.major_id,s.clazz,s.academy_id,s.campus_id
            FROM
            student s
            INNER JOIN
            (
               SELECT
               cz.clazz,m_e.major_id,a_e.academy_id,ca_e.campus_id
               FROM employee e
               LEFT JOIN clazz_employee cz_e
               ON cz_e.employee_id=e.id
               LEFT JOIN major_employee m_e
               ON m_e.employee_id=e.id
               LEFT JOIN clazz cz
               ON cz.id=cz_e.clazz_id AND cz.major_id=m_e.major_id
               LEFT JOIN academy_employee a_e
               ON a_e.employee_id=e.id
               LEFT JOIN campus_employee ca_e
               ON ca_e.employee_id=e.id
               WHERE
               e.id=#{id}
            )  com
            ON
            s.clazz=com.clazz OR s.major_id=com.major_id OR
            s.academy_id=com.academy_id OR s.campus_id=com.campus_id
         ) stu
         ON
         le.student_id=stu.id
    </select>



</mapper>